@model PetClinicSystem.Models.Schedule

@{
    string start = Model.Slot?.StartTime.ToString("hh\\:mm") ?? "-";
    string end = Model.Slot?.EndTime.ToString("hh\\:mm") ?? "-";
    string status = (Model.Status ?? "Pending").ToLower();

    string badgeClass = status switch
    {
        "confirmed" => "bg-primary",
        "pending" => "bg-secondary",
        "urgent" => "bg-danger",
        "completed" => "bg-success",
        "cancelled" => "bg-dark",
        _ => "bg-secondary"
    };

    string urgentStyle = status == "urgent"
        ? "border:2px solid #dc3545; box-shadow:0 0 10px rgba(220,53,69,.35);"
        : "";
}

<div class="col-12">
    <div class="card shadow-sm rounded-4 p-3 mb-3 appointment-card" style="@urgentStyle">
        <div class="row g-0">

            <!-- TIME -->
            <div class="col-md-2 d-flex flex-column justify-content-center align-items-center border-end">
                <h5 class="fw-bold text-success mb-0">@start - @end</h5>
                <small class="text-muted">@Model.ScheduleDateOld?.ToString("MMM dd, yyyy")</small>
            </div>

            <!-- DETAILS -->
            <div class="col-md-7 px-4">
                <h5 class="fw-bold mb-1">@Model.Pet?.Name</h5>
                <div class="text-muted small">@Model.Pet?.Species - @Model.Pet?.Breed</div>

                <div class="mt-3 small">
                    <span class="fw-semibold d-block">Owner</span>
                    <span class="text-muted">
                        @Model.Pet?.Owner?.FullName • @Model.Pet?.Owner?.PhoneNumber
                    </span>
                </div>

                <div class="mt-3 small">
                    <span class="fw-semibold d-block">Assigned Staff</span>
                    <span class="text-muted">@Model.Staff?.FullName</span>
                </div>
            </div>

            <!-- STATUS + BUTTONS -->
            <div class="col-md-3 d-flex flex-column justify-content-between align-items-end">

                <span class="badge text-uppercase @badgeClass px-3 py-2">@status</span>

                <div class="d-flex gap-2">
                    <button class="btn btn-outline-success btn-sm" onclick="loadView(@Model.ScheduleId)">View</button>

                    @if ((Context.Session.GetInt32("UserRole") ?? -1) is 1 or 2)
                    {
                        <button class="btn btn-outline-primary btn-sm" onclick="loadEdit(@Model.ScheduleId)">Edit</button>
                    }
                </div>

            </div>
        </div>
    </div>
</div>
